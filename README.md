# 📱 iOS性能监控Web可视化

基于原始`main.py`逻辑的实时性能监控可视化界面，保持完全相同的核心逻辑，增加了Web图表显示功能。

## ✨ 功能特性

- 🔄 **实时监控**: 基于原始main.py的完整逻辑
- 📊 **可视化图表**: CPU、内存、FPS、线程数的实时曲线图
- 🌐 **Web界面**: 美观的响应式Web界面
- 📱 **iOS设备支持**: 支持iOS 17+设备性能监控
- 🎯 **应用特定监控**: 可指定Bundle ID监控特定应用

## 📦 项目结构

```
ios性能/
├── main.py                 # 原始性能监控脚本（未修改）
├── web_visualizer.py       # Web可视化服务器（基于main.py逻辑）
├── start_web_monitor.py    # 启动脚本
├── templates/
│   └── index.html         # Web可视化界面
├── venv/                  # Python虚拟环境
├── requirements.txt       # 依赖包列表
└── README.md             # 说明文档
```

## 🚀 快速开始

### 1. 启动Web监控界面

```bash
# 方法1: 使用启动脚本（推荐）
python start_web_monitor.py

# 方法2: 手动启动
source venv/bin/activate
python web_visualizer.py
```

### 2. 访问Web界面

启动后自动打开浏览器访问: http://localhost:5000

### 3. 配置监控参数

在Web界面中设置:
- **设备UDID**: 留空使用默认连接的设备
- **Bundle ID**: 指定要监控的应用包名，留空监控所有进程

### 4. 开始监控

点击"开始监控"按钮，即可看到实时的性能曲线图

## 📊 监控指标

### CPU使用率
- 实时显示应用CPU占用百分比
- 红色曲线图，范围0-100%

### 内存使用量
- 显示应用物理内存占用
- 蓝色曲线图，单位MB

### 帧率(FPS)
- 显示应用渲染帧率
- 绿色曲线图，范围0-60FPS

### 线程数量
- 显示应用当前线程数
- 橙色曲线图

## 🔧 技术实现

### 核心逻辑保持一致
- `TunnelManager`: 完全复制原始tunnel管理逻辑
- `PerformanceAnalyzer`: 保持相同的数据收集方式
- 权限检查: 完全相同的管理员权限验证

### Web技术栈
- **后端**: Flask + Socket.IO (实时数据传输)
- **前端**: HTML5 + Chart.js (图表渲染)
- **样式**: CSS3 (Apple Design风格)

### 数据流程
1. Web服务器复制main.py的完整逻辑
2. 通过WebSocket实时推送性能数据
3. 前端Chart.js渲染实时曲线图
4. 同时保持原始console输出

## 📋 系统要求

- macOS (推荐) / Linux
- Python 3.13+
- 管理员权限
- iOS设备已连接并信任电脑

## 🛠️ 依赖包

主要依赖包已安装在虚拟环境中:
- `py_ios_device`: iOS设备通信
- `pymobiledevice3`: iOS设备管理
- `flask`: Web框架
- `flask-socketio`: 实时通信

## 💡 使用技巧

1. **设备连接**: 确保iOS设备通过USB连接并信任电脑
2. **权限要求**: 需要管理员权限访问iOS设备
3. **应用监控**: 输入Bundle ID可监控特定应用性能
4. **数据保留**: 图表最多保留50个数据点，自动滚动显示
5. **实时性**: 数据每秒更新，与原始main.py保持一致

## 🔍 故障排除

### 连接问题
- 检查iOS设备是否已连接
- 确认设备已信任此电脑
- 验证是否有管理员权限

### 监控问题
- 确认Bundle ID输入正确
- 检查应用是否正在运行
- 查看控制台输出的详细信息

### Web界面问题
- 确认端口5000未被占用
- 检查防火墙设置
- 尝试刷新浏览器页面

## 📝 注意事项

- Web可视化系统完全基于原始main.py逻辑构建
- 原始main.py文件保持不变，可继续单独使用
- Web界面仅增加可视化功能，不影响核心监控逻辑
- 建议在开发和测试环境中使用

## 🤝 技术说明

这个Web可视化系统是在不修改原始`main.py`代码的前提下，完全复制其核心逻辑并增加Web可视化功能。这确保了:

1. **逻辑一致性**: 与原始脚本完全相同的数据收集方式
2. **功能完整性**: 保持所有原有功能不变
3. **扩展性**: 增加了实时图表和Web界面
4. **兼容性**: 原始脚本可继续独立使用
